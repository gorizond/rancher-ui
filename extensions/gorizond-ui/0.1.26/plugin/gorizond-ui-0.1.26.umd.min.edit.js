(("undefined"!==typeof self?self:this)["webpackChunkgorizond_ui_0_1_26"]=("undefined"!==typeof self?self:this)["webpackChunkgorizond_ui_0_1_26"]||[]).push([[739],{2457:function(e,t,a){"use strict";a.r(t);var l=a(36758),o=a.n(l),i=a(40935),r=a.n(i),s=r()(o());s.push([e.id,".gorizond-cluster-form .header[data-v-3c7611ee]{align-items:center;display:flex;gap:12px;justify-content:flex-start}.eyebrow[data-v-3c7611ee]{font-size:12px;font-weight:600;letter-spacing:.08em;margin-bottom:4px;text-transform:uppercase}.eyebrow[data-v-3c7611ee],.muted[data-v-3c7611ee]{color:var(--text-muted,#6b7280)}.muted.small[data-v-3c7611ee]{font-size:12px;line-height:1.4}.panel[data-v-3c7611ee]{background:var(--body-bg,#fff);border:1px solid var(--border,#e5e7eb);border-radius:8px;box-shadow:0 1px 2px rgba(15,23,42,.06)}.panel[data-v-3c7611ee],.panel-section[data-v-3c7611ee]{padding:20px}.section-head[data-v-3c7611ee]{align-items:flex-start;display:flex;gap:12px;justify-content:space-between;margin-bottom:12px}.pill[data-v-3c7611ee]{background:var(--primary-50,#e8f3ff);border-radius:9999px;color:var(--primary-600,#0f70d7);font-size:12px;font-weight:600;padding:6px 12px;white-space:nowrap}.pill.soft[data-v-3c7611ee]{background:var(--hover-bg,#f6f7fb)}.field .helper[data-v-3c7611ee],.pill.soft[data-v-3c7611ee]{color:var(--text-muted,#6b7280)}.field .helper[data-v-3c7611ee]{font-size:13px;margin-top:6px}.summary[data-v-3c7611ee]{background:var(--body-bg,#fff);border:1px solid var(--border,#e5e7eb);position:sticky;top:12px;margin-top:24px}.summary-list[data-v-3c7611ee]{display:grid;gap:12px;margin:8px 0 16px}.summary-list dt[data-v-3c7611ee]{color:var(--text-muted,#6b7280);font-size:12px;letter-spacing:.04em;text-transform:uppercase}.summary-list dd[data-v-3c7611ee]{font-weight:600;margin:4px 0 0}.summary-note[data-v-3c7611ee]{border-top:1px solid var(--border,#e5e7eb);margin-top:12px;padding-top:12px}.form-grid[data-v-3c7611ee]{align-items:flex-start;-moz-column-gap:48px;column-gap:48px;row-gap:32px;grid-template-columns:minmax(0,2fr) minmax(320px,1fr)}section.panel+section.panel[data-v-3c7611ee]{margin-top:24px}@media (max-width:1024px){.gorizond-cluster-form .header[data-v-3c7611ee]{align-items:flex-start}}@media (max-width:1280px){.form-grid[data-v-3c7611ee]{-moz-column-gap:32px;column-gap:32px;row-gap:28px}}",""]),t["default"]=s},4976:function(e,t,a){var l=a(49360);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=a(74825).A;o("86893f82",l,!0,{sourceMap:!1,shadowMode:!1})},36222:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return z}});var l=a(9274);const o={class:"p-6 space-y-6 gorizond-cluster-form"},i={class:"header"},r={class:"type-title mb-1"},s={class:"grid gap-6 xl:grid-cols-3 form-grid"},n={class:"xl:col-span-2 space-y-6"},d={class:"panel panel-section"},c={class:"grid md:grid-cols-2 gap-4"},p={class:"field"},m={class:"field"},u={class:"panel panel-section"},g={class:"grid md:grid-cols-2 gap-4"},h={class:"field"},b={class:"field"},v={class:"panel panel-section summary"},f={class:"summary-list"};function y(e,t,a,y,w,x){const k=(0,l.resolveComponent)("Banner"),V=(0,l.resolveComponent)("LabeledInput"),N=(0,l.resolveComponent)("LabeledSelect"),E=(0,l.resolveComponent)("Card");return(0,l.openBlock)(),(0,l.createElementBlock)("div",o,[w.loaded?((0,l.openBlock)(),(0,l.createBlock)(E,{key:1,showActions:!0,buttonAction:x.onSave,buttonText:"create"===a.mode?"Create":"Save",showHighlightBorder:!1},{title:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",i,[(0,l.createElementVNode)("div",null,[t[4]||(t[4]=(0,l.createElementVNode)("p",{class:"eyebrow"},"Gorizond Cluster",-1)),(0,l.createElementVNode)("h3",r,(0,l.toDisplayString)("create"===a.mode?"Create":"Edit")+" cluster ",1),t[5]||(t[5]=(0,l.createElementVNode)("p",{class:"muted"}," Choose workspace, Kubernetes release and billing plan. ",-1))])])])),body:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",s,[(0,l.createElementVNode)("div",n,[(0,l.createElementVNode)("section",d,[t[8]||(t[8]=(0,l.createElementVNode)("div",{class:"section-head"},[(0,l.createElementVNode)("div",null,[(0,l.createElementVNode)("p",{class:"eyebrow"},"Basics"),(0,l.createElementVNode)("p",{class:"muted"}," Give your cluster an identity and place it in a workspace. ")]),(0,l.createElementVNode)("span",{class:"pill"},"Required")],-1)),(0,l.createElementVNode)("div",c,[(0,l.createElementVNode)("div",p,[(0,l.createVNode)(V,{value:w.model.metadata.name,"onUpdate:value":t[0]||(t[0]=e=>w.model.metadata.name=e),label:"Cluster Name",placeholder:"Enter cluster name",required:"create"===a.mode,disabled:"create"!==a.mode,tooltip:"Cluster name is locked after creation."},null,8,["value","required","disabled"]),t[6]||(t[6]=(0,l.createElementVNode)("p",{class:"helper"}," Use a short, human-friendly name. This is used in contexts and CLI. ",-1))]),(0,l.createElementVNode)("div",m,[(0,l.createVNode)(N,{value:w.model.metadata.namespace,"onUpdate:value":t[1]||(t[1]=e=>w.model.metadata.namespace=e),label:"Workspace (Namespace)",options:w.workspaces,"option-label":"label","option-key":"value",disabled:"create"!==a.mode,required:"create"===a.mode,tooltip:"Workspace scopes Fleet bundles, credentials and billing."},null,8,["value","options","disabled","required"]),t[7]||(t[7]=(0,l.createElementVNode)("p",{class:"helper"},"Inherits workspace policies.",-1))])])]),(0,l.createElementVNode)("section",u,[t[11]||(t[11]=(0,l.createElementVNode)("div",{class:"section-head"},[(0,l.createElementVNode)("div",null,[(0,l.createElementVNode)("p",{class:"eyebrow"},"Runtime & Billing"),(0,l.createElementVNode)("p",{class:"muted"}," Choose the Kubernetes release and billing plan. ")]),(0,l.createElementVNode)("span",{class:"pill soft"},"Configurable")],-1)),(0,l.createElementVNode)("div",g,[(0,l.createElementVNode)("div",h,[(0,l.createVNode)(N,{disabled:"view"===a.mode,value:w.model.spec.kubernetesVersion,"onUpdate:value":t[2]||(t[2]=e=>w.model.spec.kubernetesVersion=e),label:"Kubernetes Version",options:w.k8sVersions,required:"",tooltip:"Latest stable release is preselected for new clusters."},null,8,["disabled","value","options"]),t[9]||(t[9]=(0,l.createElementVNode)("p",{class:"helper"}," Upgrade by editing the cluster later; downgrades are blocked. Auto-selects latest stable for new clusters. ",-1))]),(0,l.createElementVNode)("div",b,[(0,l.createVNode)(N,{disabled:"view"===a.mode,value:w.model.spec.billing,"onUpdate:value":t[3]||(t[3]=e=>w.model.spec.billing=e),label:"Billing",options:w.billingOptions,required:"",tooltip:"Defaults to free tier when no billing is set."},null,8,["disabled","value","options"]),t[10]||(t[10]=(0,l.createElementVNode)("p",{class:"helper"}," Billing can be updated after provisioning if policies allow it. ",-1))])])])]),(0,l.createElementVNode)("aside",v,[t[16]||(t[16]=(0,l.createElementVNode)("div",{class:"section-head"},[(0,l.createElementVNode)("div",null,[(0,l.createElementVNode)("p",{class:"eyebrow"},"Live preview"),(0,l.createElementVNode)("p",{class:"muted"},"Quickly verify before saving.")])],-1)),(0,l.createElementVNode)("dl",f,[(0,l.createElementVNode)("div",null,[t[12]||(t[12]=(0,l.createElementVNode)("dt",null,"Cluster",-1)),(0,l.createElementVNode)("dd",null,(0,l.toDisplayString)(w.model?.metadata?.name||"Not set yet"),1)]),(0,l.createElementVNode)("div",null,[t[13]||(t[13]=(0,l.createElementVNode)("dt",null,"Workspace",-1)),(0,l.createElementVNode)("dd",null,(0,l.toDisplayString)(x.selectedWorkspaceLabel),1)]),(0,l.createElementVNode)("div",null,[t[14]||(t[14]=(0,l.createElementVNode)("dt",null,"Kubernetes",-1)),(0,l.createElementVNode)("dd",null,(0,l.toDisplayString)(x.selectedVersionLabel),1)]),(0,l.createElementVNode)("div",null,[t[15]||(t[15]=(0,l.createElementVNode)("dt",null,"Billing",-1)),(0,l.createElementVNode)("dd",null,(0,l.toDisplayString)(x.selectedBillingLabel),1)])]),t[17]||(t[17]=(0,l.createElementVNode)("p",{class:"muted small summary-note"}," Name and workspace are locked after creation. Billing and Kubernetes version can be updated later based on policy. ",-1))])])])),_:1},8,["buttonAction","buttonText"])):((0,l.openBlock)(),(0,l.createBlock)(k,{key:0,color:"info",label:"Loading..."}))])}var w=a(9980),x=a(64415),k=a(84937),V=a(75552);async function N(e,t,a,l,o){const i=`/apis/provisioning.gorizond.io/v1/namespaces/${t}/clusters/${e}`;try{await o.dispatch("cluster/request",{url:i,method:"GET"});const r="-free"===l||""===l||null===l||void 0===l?"":l,s={spec:{kubernetesVersion:a,billing:r}};await o.dispatch("cluster/request",{url:i,method:"PATCH",headers:{"Content-Type":"application/merge-patch+json"},data:s}),await o.dispatch("management/find",{type:"provisioning.gorizond.io.cluster",id:`${t}/${e}`,opt:{force:!0}})}catch(r){if(404!==r?.code)throw r;{const i="-free"===l||""===l||null===l||void 0===l?"":l,r={apiVersion:"provisioning.gorizond.io/v1",kind:"Cluster",metadata:{name:e,namespace:t},spec:{kubernetesVersion:a,billing:i}};await o.dispatch("cluster/request",{url:`/apis/provisioning.gorizond.io/v1/namespaces/${t}/clusters`,method:"POST",data:r}),await o.dispatch("management/find",{type:"provisioning.gorizond.io.cluster",id:`${t}/${e}`,opt:{force:!0}})}}}const E="gorizond";var B={props:{value:{type:Object,default:null},mode:{type:String,required:!0}},components:{Banner:w.l,Card:k.Z,LabeledInput:x.o,LabeledSelect:V.A},data(){return{loaded:!1,model:null,workspaces:[],k8sVersions:[],billingOptions:[]}},computed:{selectedWorkspaceLabel(){return this.formatOptionLabel(this.workspaces,this.model?.metadata?.namespace,"Not selected")},selectedVersionLabel(){return this.formatOptionLabel(this.k8sVersions,this.model?.spec?.kubernetesVersion,"Select version")},selectedBillingLabel(){return this.formatOptionLabel(this.billingOptions,this.model?.spec?.billing,"Free tier")}},watch:{"model.metadata.namespace":{handler:async function(e,t){e&&e!==t&&(await this.loadBillings(e),this.billingOptions.find((e=>e.value===this.model?.spec?.billing))||(this.model.spec.billing="-free"))}}},async created(){this.model={...this.value||{},metadata:{...this.value?.metadata||{}},spec:{...this.value?.spec||{}}};const e=await this.$store.dispatch("management/request",{url:"/v1-k3s-release/releases"});this.k8sVersions=e.data.map((e=>({label:e.id.replace("+","-"),value:e.id.replace("+","-")})));const t=await this.$store.dispatch("management/findAll",{type:"management.cattle.io.fleetworkspace"}),a=t.sort(((e,t)=>new Date(t.metadata.creationTimestamp)-new Date(e.metadata.creationTimestamp)));if(this.workspaces=a.map((e=>({label:e.metadata.name,value:e.metadata.name}))),this.model?.metadata?.namespace&&await this.loadBillings(this.model.metadata.namespace),"create"===this.mode){const e=this.k8sVersions.at(-1)?.value;this.model.spec={...this.model.spec,kubernetesVersion:e||this.model.spec.kubernetesVersion||"",billing:"-free"},this.model.metadata.namespace=this.workspaces[0]?.value,this.model.metadata.namespace&&await this.loadBillings(this.model.metadata.namespace),this.ensureFreeBilling()}else this.model.spec||(this.model.spec={}),this.model.spec.billing&&""!==this.model.spec.billing||(this.model.spec.billing="-free");this.loaded=!0},methods:{formatOptionLabel(e,t,a){const l=e.find((e=>e.value===t));return l?.label||a},async loadBillings(e){try{const t=await this.$store.dispatch("cluster/request",{url:`/apis/provisioning.gorizond.io/v1/namespaces/${e}/billings`,method:"GET"}),a=t?.data||t,l=a?.items||a?.data||[],o=Array.isArray(l)?l.map((e=>({label:e.metadata?.name,value:e.metadata?.name}))):[],i=o.filter((e=>e&&e.value));this.billingOptions=[{label:"free (free tier use)",value:"-free"},...i]}catch(t){this.billingOptions=[{label:"free (free tier use)",value:"-free"}]}},ensureFreeBilling(){this.billingOptions.find((e=>"-free"===e.value))||this.billingOptions.unshift({label:"free (free tier use)",value:"-free"})},async onSave(){JSON.parse(JSON.stringify(this.model||{}));try{await N(this.model.metadata.name,this.model.metadata.namespace,this.model.spec.kubernetesVersion,"-free"!==this.model.spec.billing&&this.model.spec.billing?this.model.spec.billing:"",this.$store),this.$router.push({name:`c-cluster-${E}-resource`,params:{cluster:this.$route.params.cluster||"_",resource:"provisioning.gorizond.io.cluster"}})}catch(e){this.$store.dispatch("growl/fromError",{err:e,title:"Failed to create cluster"},{root:!0})}}}},C=(a(81304),a(47433));const S=(0,C.A)(B,[["render",y],["__scopeId","data-v-3c7611ee"]]);var z=S},49360:function(e,t,a){"use strict";a.r(t);var l=a(36758),o=a.n(l),i=a(40935),r=a.n(i),s=r()(o());s.push([e.id,".card-container{border-radius:var(--border-radius);display:flex;flex-basis:40%;margin:10px;min-height:100px;padding:10px;box-shadow:0 0 20px var(--shadow)}.card-container.highlight-border{border-left:5px solid var(--primary)}.card-container:not(.top){align-items:top;flex-direction:row;justify-content:start}.card-container .card-wrap{width:100%}.card-container .card-body{color:var(--input-label);display:flex;flex-direction:column;justify-content:center}.card-container .card-actions{align-self:end;display:flex;padding-top:20px}.card-container .card-title{align-items:center;display:flex;width:100%}.card-container .card-title h5{margin:0}.card-container .card-title .flex-right{margin-left:auto}.card-container.card-sticky{overflow:hidden}.card-container.card-sticky .card-wrap{display:flex;flex-direction:column}.card-container.card-sticky .card-wrap .card-body{justify-content:flex-start;overflow:auto}.card-container.card-sticky .card-wrap>*{flex:0}.card-container.card-sticky .card-wrap .card-body{flex:1}",""]),t["default"]=s},59478:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return b}});var l=a(9274);const o={class:"p-6 space-y-6"},i={class:"type-title"},r={class:"space-y-4"};function s(e,t,a,s,n,d){const c=(0,l.resolveComponent)("Banner"),p=(0,l.resolveComponent)("LabeledInput"),m=(0,l.resolveComponent)("LabeledSelect"),u=(0,l.resolveComponent)("Card");return(0,l.openBlock)(),(0,l.createElementBlock)("div",o,[n.loaded?((0,l.openBlock)(),(0,l.createBlock)(u,{key:1,showActions:!0,buttonAction:d.onSave,buttonText:"create"===a.mode?"Create":"Save",showHighlightBorder:!1},{title:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",i,[(0,l.createElementVNode)("h3",null,(0,l.toDisplayString)(a.mode)+" Billing",1)])])),body:(0,l.withCtx)((()=>[(0,l.createElementVNode)("div",r,[(0,l.createVNode)(p,{value:n.model.metadata.name,"onUpdate:value":t[0]||(t[0]=e=>n.model.metadata.name=e),label:"Billing Name",placeholder:"Enter billing name",required:"create"===a.mode,disabled:"create"!==a.mode},null,8,["value","required","disabled"]),(0,l.createVNode)(m,{value:n.model.metadata.namespace,"onUpdate:value":t[1]||(t[1]=e=>n.model.metadata.namespace=e),label:"Workspace (Namespace)",options:n.workspaces,"option-label":"label","option-key":"value",disabled:"create"!==a.mode,required:"create"===a.mode},null,8,["value","options","disabled","required"])])])),_:1},8,["buttonAction","buttonText"])):((0,l.openBlock)(),(0,l.createBlock)(c,{key:0,color:"info",label:"Loading..."}))])}var n=a(9980),d=a(64415),c=a(84937),p=a(75552);const m="gorizond";var u={props:{value:{type:Object,default:null},mode:{type:String,required:!0}},components:{Banner:n.l,Card:c.Z,LabeledInput:d.o,LabeledSelect:p.A},data(){return{loaded:!1,model:null,workspaces:[]}},async created(){this.model={...this.value};const e=await this.$store.dispatch("management/findAll",{type:"management.cattle.io.fleetworkspace"}),t=e.sort(((e,t)=>new Date(t.metadata.creationTimestamp)-new Date(e.metadata.creationTimestamp)));this.workspaces=t.map((e=>({label:e.metadata.name,value:e.metadata.name}))),"create"===this.mode&&(this.model=this.model||{},this.model.metadata=this.model.metadata||{},this.model.metadata.namespace=this.workspaces[0]?.value),this.loaded=!0},methods:{async onSave(){const e=JSON.parse(JSON.stringify(this.model||{}));try{if("create"===this.mode){const t={apiVersion:"provisioning.gorizond.io/v1",kind:"Billing",metadata:{name:e.metadata.name,namespace:e.metadata.namespace}};await this.$store.dispatch("cluster/request",{url:`/apis/provisioning.gorizond.io/v1/namespaces/${e.metadata.namespace}/billings`,method:"POST",data:t})}this.$router.push({name:`c-cluster-${m}-resource`,params:{cluster:this.$route.params.cluster||"_",resource:"provisioning.gorizond.io.billing"}})}catch(t){this.$store.dispatch("growl/fromError",{err:t,title:"Failed to save billing"},{root:!0})}}}},g=a(47433);const h=(0,g.A)(u,[["render",s]]);var b=h},81304:function(e,t,a){var l=a(2457);l.__esModule&&(l=l.default),"string"===typeof l&&(l=[[e.id,l,""]]),l.locals&&(e.exports=l.locals);var o=a(74825).A;o("11260318",l,!0,{sourceMap:!1,shadowMode:!1})},84937:function(e,t,a){"use strict";a.d(t,{Z:function(){return u}});var l=a(9274);const o={class:"card-wrap"},i={class:"card-title","data-testid":"card-title-slot"},r={class:"card-body","data-testid":"card-body-slot"},s={key:0,class:"card-actions","data-testid":"card-actions-slot"};function n(e,t,a,n,d,c){return(0,l.openBlock)(),(0,l.createElementBlock)("div",{id:"focus-trap-card-container-element",class:(0,l.normalizeClass)(["card-container",{"highlight-border":e.showHighlightBorder,"card-sticky":e.sticky}]),"data-testid":"card"},[(0,l.createElementVNode)("div",o,[(0,l.createElementVNode)("div",i,[(0,l.renderSlot)(e.$slots,"title",{},(()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.title),1)]))]),t[1]||(t[1]=(0,l.createElementVNode)("hr",null,null,-1)),(0,l.createElementVNode)("div",r,[(0,l.renderSlot)(e.$slots,"body",{},(()=>[(0,l.createTextVNode)((0,l.toDisplayString)(e.content),1)]))]),e.showActions?((0,l.openBlock)(),(0,l.createElementBlock)("div",s,[(0,l.renderSlot)(e.$slots,"actions",{},(()=>[(0,l.createElementVNode)("button",{class:"btn role-primary",onClick:t[0]||(t[0]=(...t)=>e.buttonAction&&e.buttonAction(...t))},(0,l.toDisplayString)(e.buttonText),1)]))])):(0,l.createCommentVNode)("",!0)])],2)}var d=a(82149),c=(0,l.defineComponent)({name:"Card",props:{title:{type:String,default:""},content:{type:String,default:""},buttonAction:{type:Function,default:()=>{}},buttonText:{type:String,default:"go"},showHighlightBorder:{type:Boolean,default:!0},showActions:{type:Boolean,default:!0},sticky:{type:Boolean,default:!1},triggerFocusTrap:{type:Boolean,default:!1}},setup(e){e.triggerFocusTrap&&(0,d.kS)("#focus-trap-card-container-element",{escapeDeactivates:!1,allowOutsideClick:!0})}}),p=(a(4976),a(47433));const m=(0,p.A)(c,[["render",n]]);var u=m}}]);
//# sourceMappingURL=gorizond-ui-0.1.26.umd.min.edit.js.map